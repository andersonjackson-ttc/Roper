Option Explicit

' read 3W and 8P schedules and create diddies for each room that is occupied
Public Sub createOldDiddies()
    
    ' declare variables
    Dim room As range
    Dim room2 As range
    Dim room3 As range
    Dim room4 As range
    Dim roomArray3W As Object
    Dim i As Integer
    Dim roomArray8P As Object
    
'    Dim nameAndProf As Variant
    

'    Dim timeCreated As range

    
'    ' set timeCreated box in diddies sheet
'    Set timeCreated = Sheets("All Diddies").range("$H$13")
      
    ' disable alerts about replacing data in non-blank cells
    Application.DisplayAlerts = False
    
    ' clear diddies
    Call clearOldDiddies
    
    
    ' create room arrays
    Set roomArray3W = CreateObject("System.Collections.ArrayList")
    Set roomArray8P = CreateObject("System.Collections.ArrayList")
    
    
   ' Add occupied rooms in 3W to roomArray3W
    For Each room In Sheets("3W Schedule").range("Rooms3WSchedule")
        If Not room.Offset(0, 23) = " " And Not room.Offset(0, 24) = " " And Not room.Offset(0, 23) = "" And Not room.Offset(0, 24) = "" Then
          ' add room number to first roomArray3W
          roomArray3W.Add (room.value)
        End If
    Next room
    
    ' Add occupied rooms in 8P to roomArray8P
    For Each room2 In Sheets("8P Schedule").range("Rooms8PSchedule")
        If Not room2.Offset(0, 23) = " " And Not room2.Offset(0, 24) = " " And Not room2.Offset(0, 23) = "" And Not room2.Offset(0, 24) = "" Then
          ' add room number to first roomArray3W
          roomArray8P.Add (room2.value)
        End If
    Next room2
        
   ' Add 3W rooms to old diddies
   i = 0
   For Each room3 In Sheets("AllDiddiesOld").range("Rooms3WRowAD")
        room3.value = roomArray3W.Item(i)
        i = i + 1
        If i > roomArray3W.Count - 1 Then
            Exit For
        End If
   Next room3
    
   
    ' Add 8P rooms to old diddies
    i = 0
    For Each room4 In Sheets("AllDiddiesOld").range("Rooms8PRowAD")
         room4.value = roomArray8P.Item(i)
         i = i + 1
         If i > roomArray8P.Count - 1 Then
             Exit For
         End If
    Next room4

'    ' display diddie counts
'    Sheets("All Diddies").range("$I$7").value = count3W
'    Sheets("All Diddies").range("$I$8").value = count8P
'    Sheets("All Diddies").range("$I$9").value = count3P
'    Sheets("All Diddies").range("$I$10").value = count3W + count8P + count3P
    
'    ' show time the schedule was last created
'    Call lastTimeCreated(timeCreated)
    
    ' turn alerts back on
    Application.DisplayAlerts = True
    
End Sub





